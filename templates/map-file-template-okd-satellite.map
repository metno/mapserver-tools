MAP
  IMAGETYPE      GTiff
  SIZE           {{ data['xsize'] }} {{ data['ysize'] }}
  IMAGECOLOR     255 255 255

  WEB
    METADATA
      "wms_title"          "WMS senda test/demo server localhost"  ##required
      "wms_onlineresource" "{{ data['server_name'] }}/cgi-bin/mapserv?map={{ data['map_file_name'] }}&"   ##required
      "wms_srs"            "EPSG:3978 EPSG:4326 EPSG:4269 EPSG:3857"  ##recommended
      "wms_enable_request" "*"   ##necessary
    END
  END # Web

  PROJECTION
    "init=epsg:25833"
  END

  OUTPUTFORMAT
    NAME "GTiff"
    DRIVER GDAL/GTiff
    MIMETYPE "image/tiff"
    IMAGEMODE RGB
    EXTENSION "tif"
  END

  # Layer objects are defined beneath the map object.  You need at least one
  # layer defined in your map file before you can display a map...  You can
  # define as many layers as you'd like.

  # Start of LAYER DEFINITIONS ---------------------------------------------
  {% for layer in data['layers'] %}
  LAYER
    NAME "{{ layer['layer_name'] }}"
    STATUS ON
    TYPE raster
    PROCESSING   "BANDS=1,2,3,4"
    OFFSITE      0 0 0
    
    DATA {{ layer['geotiff_filename'] }}
    METADATA
      "wms_title" "{{ layer['layer_title'] }}"
      "wms_timeextent" "{{ layer['geotiff_timestamp']}}/{{ layer['geotiff_timestamp'] }}"
      "wms_enable_request" "*"
    END
    FILTER (`[TIME]` = `{{ layer['geotiff_timestamp'] }}`)
  END
  {% endfor %}
  # End of LAYER DEFINITIONS -------------------------------

END # All map files must come to an end just as all other things must come to...
